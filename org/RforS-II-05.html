<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-12-13 月 14:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>5章 統計的仮説検定</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="suzuki@iwate-u.ac.jp 鈴木正幸，非常勤講師" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://wiki.cis.iwate-u.ac.jp/~suzuki/org-html-theme/styles/bigblow/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/bigblow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
<div id="content">
<h1 class="title">5章 統計的仮説検定</h1>

<div id="outline-container-org82eb2fa" class="outline-2">
<h2 id="org82eb2fa">5.0 はじめに</h2>
<div class="outline-text-2" id="text-org82eb2fa">
<p>
統計的仮説検定は、推測統計の中でも利用頻度の高い重要なもの。
</p>

<p>
以後，代表的な統計的仮説検定の方法について説明する:
</p>

<ul class="org-ul">
<li>統計的仮説検定の手順と様々な用語の説明</li>
<li>標準正規分布を使った検定、</li>
<li>t分布を使った検定、</li>
<li>無相関検定、</li>
<li>カイ二乗検定</li>
</ul>
</div>
</div>

<div id="outline-container-orgbbfe9f0" class="outline-2">
<h2 id="orgbbfe9f0">5.1 統計的仮説検定の必要性</h2>
<div class="outline-text-2" id="text-orgbbfe9f0">
<ul class="org-ul">
<li>「日本人大学生の自尊感情とソーシャルスキルの間に相関関係がある」と主張
するために，</li>

<li>50人の無作為標本から相関係数を推測し，0.5 であった。そこから，「自尊
感情とソーシャルスキルの間に相関関係がある」と結論した。</li>

<li>反論: 母集団には相関関係がないのに，相関関係が見られる標本を抽出した
だけでは？</li>

<li><p>
母集団全てを調べることなく，反論するには，
</p>

<p>
無相関の母集団からの無作為標本に相関関係が見られる確率が非常に少ない
ことを示す。
</p></li>
</ul>

<p>
言い代えると：
</p>

<ul class="org-ul">
<li>母集団の全データを調べることなく，</li>

<li>標本統計量だけを用いて計算し，</li>

<li>仮説が現実的に起こる確率が非常に低いことを示すことで，</li>

<li>仮説を棄却する</li>
</ul>
</div>
</div>

<div id="outline-container-org8a215b5" class="outline-2">
<h2 id="org8a215b5">教科書の図5.1 母集団と標本</h2>
<div class="outline-text-2" id="text-org8a215b5">
<p>
<a href="http://www.cc.aoyama.ac.jp/~t41338/lecture/aoyama/stat2e/stat2e_top.html">社会統計演習</a> 5.1の補足説明スライドに詳しい解説があります。
</p>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">#</span>
<span style="color: #99968b;"># </span><span style="color: #99968b;">&#22259;5.1 &#27597;&#38598;&#22243;&#12392;&#27161;&#26412;</span>
<span style="color: #99968b;">#</span>
sample.size <span style="color: #e5786d;">&lt;-</span> 500
A <span style="color: #e5786d;">&lt;-</span> rnorm(sample.size)
B <span style="color: #e5786d;">&lt;-</span> rnorm(sample.size)
C <span style="color: #e5786d;">&lt;-</span> A*0.5 + sqrt(0.75)*B
&#33258;&#23562;&#24863;&#24773;s <span style="color: #e5786d;">&lt;-</span> 10*A + 50
&#12477;&#12540;&#12471;&#12515;&#12523;&#12473;&#12461;&#12523;s <span style="color: #e5786d;">&lt;-</span> 10*C + 50

plot(&#33258;&#23562;&#24863;&#24773;s, &#12477;&#12540;&#12471;&#12515;&#12523;&#12473;&#12461;&#12523;s,
     xlim=c(0,100), ylim=c(0,100))
points(50, 50, cex=45) <span style="color: #99968b;"># </span><span style="color: #99968b;">&#27597;&#38598;&#22243;&#12434;&#22258;&#12416;&#20870;</span>
legend(50, 10, legend=<span style="color: #95e454;">"&#25277;&#20986;&#12373;&#12428;&#12383;&#27161;&#26412;&#12395;&#21547;&#12414;&#12428;&#12427;&#12487;&#12540;&#12479;"</span>,pch=1)
legend(10, 100, legend=<span style="color: #95e454;">"&#27597;&#38598;&#22243; (&#20870;&#12398;&#20013;&#20840;&#20307;&#12395;&#12487;&#12540;&#12479;&#12364;&#25955;&#12425;&#12400;&#12387;&#12390;&#12356;&#12390;&#30456;&#38306;&#12399;&#12476;&#12525;)"</span>)

</pre>
</div>


<div class="figure">
<p><img src="RforS/graph/Fig-5.1.png" alt="Fig-5.1.png" />
</p>
</div>


<div class="figure">
<p><img src="./RforS/graph/Fig-5.1.png" alt="Fig-5.1.png" />
</p>
</div>
</div>


<div id="outline-container-orgc495c51" class="outline-3">
<h3 id="orgc495c51">自尊感情とソーシャルスキルの間にできた相関関係</h3>
<div class="outline-text-3" id="text-orgc495c51">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">#</span>
<span style="color: #99968b;"># </span><span style="color: #99968b;">&#33258;&#23562;&#24863;&#24773;&#12392;&#12477;&#12540;&#12471;&#12515;&#12523;&#12473;&#12461;&#12523;&#12398;&#38291;&#12395;&#12391;&#12365;&#12383;&#30456;&#38306;&#38306;&#20418;</span>
<span style="color: #99968b;">#</span>

cor(&#33258;&#23562;&#24863;&#24773;s, &#12477;&#12540;&#12471;&#12515;&#12523;&#12473;&#12461;&#12523;s)

</pre>
</div>

<pre class="example">
[1] 0.5346852

</pre>

<p>
標準正規分布からの二つの独立な標本，\(\vec{A}\), \( \vec{B} \) から
\(\vec{C} = 1/2 \vec{A} + \sqrt{3} / 2 \vec{B} \)を作り，\(\vec{A}\) と
\( \vec{C} \) をそれぞれ10倍し50足したものを，自尊感情とソーシャルスキ
ルにする。
</p>

<p>
すると，自尊感情とソーシャルスキルの間に相関関係が生れることになる。
</p>
</div>

<div id="outline-container-org51e58ba" class="outline-4">
<h4 id="org51e58ba">ベクトルの内積と相関係数に</h4>
<div class="outline-text-4" id="text-org51e58ba">
<div class="org-src-container">
<pre class="src src-R">
<span style="color: #99968b;">##</span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#12505;&#12463;&#12488;&#12523;&#12398;&#20869;&#31309;&#12392;&#30456;&#38306;&#20418;&#25968;&#12395;</span>
<span style="color: #99968b;">##</span>

A <span style="color: #e5786d;">%*%</span> A /length(A)  <span style="color: #99968b;">## </span><span style="color: #99968b;">&#20869;&#31309;</span>
A <span style="color: #e5786d;">%*%</span> B /length(A)  <span style="color: #99968b;">## </span><span style="color: #99968b;">&#20869;&#31309;</span>
sum(A^2) /length(A)

(A-mean(A)) <span style="color: #e5786d;">%*%</span> (B-mean(B)) /length(A)
</pre>
</div>

<pre class="example">
         [,1]
[1,] 0.970859
           [,1]
[1,] 0.01688769
[1] 0.970859
           [,1]
[1,] 0.01320886

</pre>

<div class="org-src-container">
<pre class="src src-R">cor(A,B)
cor(A-mean(A), B-mean(B))
cor(A,C)
cor(B,C)

</pre>
</div>

<pre class="example">
[1] 0.01377069
[1] 0.01377069
[1] 0.5129959
[1] 0.865374

</pre>
</div>
</div>

<div id="outline-container-org07b66ff" class="outline-4">
<h4 id="org07b66ff">標本とベクトル</h4>
<div class="outline-text-4" id="text-org07b66ff">
<ul class="org-ul">
<li>標本は，多次元確率変数の実現値。</li>
<li>多次元確率変数の値は，標本。</li>
<li>標本は標本値のベクトル。</li>
<li>分散は，中心化した値の平方和。
中心化した値のベクトルの長さの2乗。</li>

<li>2つの標本の相関は，ベクトルの内積</li>
<li>標本が無相関のときは，ベクトルが直交すること。</li>
</ul>



<dl class="org-dl">
<dt>標本平均</dt><dd>\( \overline{X} \equiv \frac{1}{n} \Sigma_{i} X_i \)</dd>

<dt>標本分散</dt><dd>\( \sigma_{XX}^2 \equiv \frac{1}{n}   \Sigma_i  (X_i-\overline{X})^2 \)</dd>

<dt>共分散</dt><dd>\( \sigma_{XY}^{2} = \frac{1}{n}
  \Sigma_i  (X_i-\overline{X}) (Y_i-\overline{Y}) \)</dd>

<dt>相関係数</dt><dd>\( r \equiv \frac { \sigma_{XY}^{2} }
  {\sqrt{ \sigma_{XX}^2  \sigma_{YY}^2 }} \)</dd>
</dl>
</div>
</div>
</div>
</div>

<div id="outline-container-org80f44a3" class="outline-2">
<h2 id="org80f44a3">5.2 統計的仮説検定の手順と用語</h2>
<div class="outline-text-2" id="text-org80f44a3">
<ul class="org-ul">
<li>母集団に関する帰無仮説と対立仮説を設定する</li>
<li>検定統計量を選ぶ</li>
<li>有意水準 \( \alpha \) を決める</li>
<li>検定統計量の実現値を求める</li>
<li>帰無仮説の棄却，対立仮説の採択</li>
</ul>
</div>

<div id="outline-container-org446deab" class="outline-3">
<h3 id="org446deab">5.2.1 帰無仮説と対立仮説</h3>
<div class="outline-text-3" id="text-org446deab">
<dl class="org-dl">
<dt>帰無仮説</dt><dd><p>
提案する手法が従来の手法と「差がない」、 提案する手法は
「効果がない」という仮説&#x2014;本来主張したいこととは逆の仮説。 この仮説
が棄却されることを目標として仮説検定を行う。
</p>

<p>
具体的には、母平均μ=0 (母平均は0である), 母相関係数 ρ=0 (相関がな
い), 母平均の差μ1 - μ2= 0 (差がない)というような仮説
</p></dd>

<dt>対立仮説</dt><dd><p>
帰無仮説が棄却されたときに採択される仮説
</p>

<p>
帰無仮説とは逆の仮説であり、実験などで示したい・主張したいことを表し
たもの
</p>

<p>
具体的には、母平均μ≠0 (母平均は0でない), 母相関係数 ρ≠0 (相関が
ある), 母平均の差μ1 - μ2≠ 0 (差がある)というような仮説
</p></dd>
</dl>

<p>
対立仮説の設定により、検定は次のどちらかで行う (両側検定の方がより厳し
い条件であり、普通は両側検定で行う):
</p>

<ul class="org-ul">
<li>片側検定：対立仮説が、母平均μ &gt; 0 (もしくはμ &lt; 0 )、 、母相関係数
ρ &gt; 0 (もしくはρ &lt; 0 )、、母平均の差μ1 &gt; μ2 (もしくはμ1 &lt; μ2 )、
の場合</li>

<li><p>
両側検定：対立仮説が、母平均μ≠0、母相関係数ρ≠0 、母平均の差 μ1 -
μ2≠ 0の場合
</p>

<p>
両側検定では、例えば母平均μ≠0を調べるには、母平均μ &gt; 0 とμ &lt; 0
の両方を調べなければならない
</p></li>
</ul>

<p>
帰無仮説が正しいものとして分析を行う。 実際に得られたデータから計算さ
れた検定統計量の値によって採択を判断する。
</p>

<ul class="org-ul">
<li>帰無仮説が正しいとしたとき、検定統計量が、ほぼ起こり得ない値(それほ
ど極端な値)であれば、帰無仮説を棄却する(つまり、本来の主張を表す対立
仮説が採択される)。</li>

<li><p>
そうでなければ, つまり，確率的に十分起こりうるような値であれば、
帰無仮説を採択する.
</p>

<p>
この場合は、本来主張したかった対立仮説が棄却されてしまう。
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org85b4a71" class="outline-3">
<h3 id="org85b4a71">5.2.2 検定統計量</h3>
<div class="outline-text-3" id="text-org85b4a71">
<dl class="org-dl">
<dt>検定統計量</dt><dd>統計的仮説検定のために用いられる標本統計量のこと。
代表的な検定統計量の例: t, χ2、F</dd>

<dt>検定統計量の実現値</dt><dd>実際のデータ（手に入った標本）を基に計算し
てえられる具体的な値のこと</dd>
</dl>

<p>
検定統計量の実現値は、対立仮説に合うほど 0から離れた値を示す
</p>
</div>
</div>

<div id="outline-container-org93e0fe4" class="outline-3">
<h3 id="org93e0fe4">5.2.3 有意水準と棄却域</h3>
<div class="outline-text-3" id="text-org93e0fe4">
<dl class="org-dl">
<dt>有意水準 \( \alpha \)</dt><dd><p>
対立仮説を採択するか決定するときの基準。
</p>

<p>
有意水準は5％または1％(α=0.05またはα=0.01)に設定することが多い
</p>

<ul class="org-ul">
<li>標本が100回に5回(5%の場合)以下にしか現れないデータであった</li>
<li>こんなことは偶然では起こりえない</li>
<li>だから帰無仮説が成り立たないと考えて良いのではないか、という判断基準</li>
</ul></dd>

<dt>帰無分布</dt><dd>帰無仮説が正しいものとして考えた時の標本分布

<ul class="org-ul">
<li>帰無分布に基づいて確率計算される</li>
</ul></dd>

<dt>棄却域</dt><dd>帰無仮説のもとで、非常に生じにくい検定統計量の値の範囲

<ul class="org-ul">
<li>帰無仮説が棄却される領域 (だから、この範囲に入るのが <b>望ましい</b>)</li>

<li>棄却域に検定統計量の実現値が入ったら、帰無仮説を棄却する. 
<ul class="org-ul">
<li>本来主張したかったことが採択される *</li>
</ul></li>
</ul></dd>

<dt>採択域</dt><dd>棄却域以外の部分&#x2014;「帰無仮説が採択される領域」</dd>

<dt>臨界値</dt><dd>棄却域と採択域の境目の値</dd>
</dl>
</div>
</div>


<div id="outline-container-org4e11a53" class="outline-3">
<h3 id="org4e11a53">5.2.4 統計的仮説検定の結果の報告</h3>
<div class="outline-text-3" id="text-org4e11a53">
<p>
検定統計量の実現値が棄却域に入った場合、「差がない」という帰無仮説を棄
却し、「差がある」という対立仮説を採択する。
</p>

<ul class="org-ul">
<li>「検定結果は5% (または1%) 水準で有意である」</li>

<li>または 「p &lt; .05 (または p &lt; .01 )で有意差が見られた 」 と記述する。</li>
</ul>

<p>
帰無仮説が棄却できない場合は、「検定の結果、差が有意でなかった」または
「有意差が認められなかった」と書く。
</p>
</div>
</div>

<div id="outline-container-orge137f45" class="outline-3">
<h3 id="orge137f45">5.2.5 p 値</h3>
<div class="outline-text-3" id="text-orge137f45">
<dl class="org-dl">
<dt>p 値</dt><dd><p>
帰無分布で，検定統計量の実現値以上の領域が起る確率。
</p>

<p>
p値が有意水準より小さいとき帰無仮説を棄却する。
</p></dd>
</dl>
</div>
</div>

<div id="outline-container-orgba42448" class="outline-3">
<h3 id="orgba42448">5.2.6 第1 種の誤りと第2 種の誤り</h3>
<div class="outline-text-3" id="text-orgba42448">
<dl class="org-dl">
<dt>第1種の誤り \( \alpha \)</dt><dd>「帰無仮説が真のとき，帰無仮説を棄却して
   しまう」誤り
のこと</dd>

<dt>第2種の誤り \( \beta \)</dt><dd>「帰無仮説が偽のとき，帰無仮説を採択して
しまう」誤りのこと</dd>
</dl>
</div>
</div>

<div id="outline-container-org171588e" class="outline-3">
<h3 id="org171588e">5.2.7 検定力</h3>
<div class="outline-text-3" id="text-org171588e">
<dl class="org-dl">
<dt>検定力</dt><dd><p>
帰無仮説が偽の場合、全体の確率1から第2種の誤りの確率(1 -
β)を引いた確率「第2種の誤りを犯さない確率」とも、つまり間違っている
帰無仮説を正しく棄却できる確率のこと　
</p>

<p>
帰無分布 \( ( \mu = \mu_0)  \) での臨界点を z* とすると，対立分布 \(
  ( \mu = \mu_1, \mu_0 < \mu_1 の場合)  \) での z* 以下の確率が
\(\beta\).  \( 1- \beta \) が検定力。
</p></dd>
</dl>
</div>
</div>


<div id="outline-container-org5fa5e4a" class="outline-3">
<h3 id="org5fa5e4a">「有意差がない」ということ</h3>
<div class="outline-text-3" id="text-org5fa5e4a">
<ul class="org-ul">
<li>「実験や調査で得られた「条件間の差」は，標本抽出による誤差によって，十
分起り得る差です」ということ。</li>

<li>「統計的に意味のある差ではない」ということ。</li>

<li>有意差がみられなかったとしても，「同じである」ということではない。</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org01528cd" class="outline-2">
<h2 id="org01528cd">5.3 標準正規分布を用いた検定（1 つの平均値の検定・母分散σ2 が既知）</h2>
<div class="outline-text-2" id="text-org01528cd">
<ul class="org-ul">
<li>\( N(\mu, \sigma^2) \) からの標本による標本の</li>
<li>標本平均の標本分布は，\( \overline{X} \sim N(\mu, \frac{\sigma^2}{n})\)</li>
<li>標準化  \( Z = \frac{\bar{X} -\mu} {\sigma \sqrt{n}} \)</li>
</ul>
</div>


<div id="outline-container-org11d43b5" class="outline-3">
<h3 id="org11d43b5">標本</h3>
<div class="outline-text-3" id="text-org11d43b5">
<p>
<a href="http://www.cc.aoyama.ac.jp/~t41338/lecture/aoyama/stat2e/stat2e_top.html">社会統計演習</a>からshidouhouU8.csv をダウンロードしてください。
</p>

<div class="org-src-container">
<pre class="src src-R">     <span style="color: #99968b;">##</span>
     <span style="color: #99968b;">## </span><span style="color: #99968b;">&#25351;&#23566;&#27861;&#12487;&#12540;&#12479;</span>
     <span style="color: #99968b;">##</span>
     &#25351;&#23566;&#27861;&#12487;&#12540;&#12479; <span style="color: #e5786d;">&lt;-</span> read.csv(<span style="color: #95e454;">"RforS/data/shidouhouU8.csv"</span>)
     class(&#25351;&#23566;&#27861;&#12487;&#12540;&#12479;)
     (&#24515;&#29702;&#23398;&#12486;&#12473;&#12488; <span style="color: #e5786d;">&lt;-</span> &#25351;&#23566;&#27861;&#12487;&#12540;&#12479;$psych_test)

</pre>
</div>

<pre class="example">
[1] "data.frame"
 [1] 13 14  7 12 10  6  8 15  4 14  9  6 10 12  5 12  8  8 12 15

</pre>
</div>
</div>


<div id="outline-container-orgd089d01" class="outline-3">
<h3 id="orgd089d01">統計検定量の選択</h3>
<div class="outline-text-3" id="text-orgd089d01">
<p>
母集団が N(12, 10)なので
</p>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">##</span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">Z&#26908;&#23450;&#37327;</span>
<span style="color: #99968b;">##</span>
this.mean <span style="color: #e5786d;">&lt;-</span> 12
this.sd <span style="color: #e5786d;">&lt;-</span> sqrt(10)

<span style="color: #cae682;">z_stat</span> <span style="color: #e5786d;">&lt;-</span> <span style="color: #8ac6f2; font-weight: bold;">function</span> (x) {
  (mean(x)-this.mean) / (this.sd/sqrt(length(x)))
}

norm_stat(&#24515;&#29702;&#23398;&#12486;&#12473;&#12488;)
</pre>
</div>

<pre class="example">
[1] -2.828427

</pre>
</div>
</div>

<div id="outline-container-orga8f4136" class="outline-3">
<h3 id="orga8f4136">帰無仮説と対立仮説の設定</h3>
<div class="outline-text-3" id="text-orga8f4136">
<dl class="org-dl">
<dt>帰無仮説</dt><dd>\( \mu = 12\)</dd>
<dt>対立仮説</dt><dd>\( \mu \neq 12 \)</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf1b0fce" class="outline-3">
<h3 id="orgf1b0fce">有意水準の決定</h3>
<div class="outline-text-3" id="text-orgf1b0fce">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">##</span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#26377;&#24847;&#27700;&#28310;&#12398;&#27770;&#23450;</span>
<span style="color: #99968b;">##</span>
this.alpha <span style="color: #e5786d;">&lt;-</span> 0.05

</pre>
</div>
</div>
</div>

<div id="outline-container-org308ac10" class="outline-3">
<h3 id="org308ac10">検定統計量の実現値を求める</h3>
<div class="outline-text-3" id="text-org308ac10">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">##</span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#26908;&#23450;&#32113;&#35336;&#37327;&#12398;&#23455;&#29694;&#20516;&#12434;&#27714;&#12417;&#12427;</span>
<span style="color: #99968b;">##</span>
(z <span style="color: #e5786d;">&lt;-</span> norm_stat(&#24515;&#29702;&#23398;&#12486;&#12473;&#12488;))

</pre>
</div>

<pre class="example">
[1] -2.828427

</pre>
</div>
</div>

<div id="outline-container-org51e56d5" class="outline-3">
<h3 id="org51e56d5">帰無仮説の棄却 or 採択の決定</h3>
<div class="outline-text-3" id="text-org51e56d5">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">##</span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#24112;&#28961;&#20206;&#35500;&#12398;&#26820;&#21364; or &#25505;&#25246;&#12398;&#27770;&#23450;</span>
<span style="color: #99968b;">##</span>
<span style="color: #8ac6f2; font-weight: bold;">if</span> ( pnorm(z)*2 &gt; this.alpha ) {  print(<span style="color: #95e454;">"mu==12"</span>)  } <span style="color: #8ac6f2; font-weight: bold;">else</span> {   print(<span style="color: #95e454;">"mu/=12"</span>) }

</pre>
</div>

<pre class="example">
[1] "mu/=12"

</pre>
</div>
</div>

<div id="outline-container-orgd7ed318" class="outline-3">
<h3 id="orgd7ed318">棄却域の描画</h3>
<div class="outline-text-3" id="text-orgd7ed318">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #99968b;">## </span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#26820;&#21364;&#22495;&#12398;&#25551;&#30011;</span>
<span style="color: #99968b;">##</span>
curve(dnorm(x), -3, 3)
z.lower <span style="color: #e5786d;">&lt;-</span> qnorm(this.alpha/2)
z.upper <span style="color: #e5786d;">&lt;-</span> qnorm(1-this.alpha/2)
abline(v=z.lower)
abline(v=z.upper)
curve(x-x-0.01, xlim=c(-3,z.lower), col=<span style="color: #95e454;">'green'</span>,lwd=10,add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)
curve(x-x-0.01, xlim=c(z.upper,3), col=<span style="color: #95e454;">'green'</span>,lwd=10,add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)
</pre>
</div>


<div class="figure">
<p><img src="./RforS/graph/fig-05-02.png" alt="fig-05-02.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd97873a" class="outline-2">
<h2 id="orgd97873a">5.4 t 分布を用いた検定（1 つの平均値の検定・母分散σ2 が未知）</h2>
<div class="outline-text-2" id="text-orgd97873a">
<ul class="org-ul">
<li>分散未知の \( N(\mu, \sigma^2) \) からの標本，</li>
<li>標本平均の標本分布は，\( \overline{X} \sim N(\mu, \frac{\sigma^2}{n})\)</li>
<li>スチューデント化  \( t = \frac{\overline{X} -\mu} {\hat{\sigma}
      \sqrt{n}} \),
\( \hat{\sigma} \)は，不偏分散の正の平方根</li>
</ul>
</div>

<div id="outline-container-org509a0fb" class="outline-3">
<h3 id="org509a0fb">t-分布</h3>
<div class="outline-text-3" id="text-org509a0fb">
<ul class="org-ul">
<li>自由度1，2，4，8，16 の t-分布のグラフ</li>
<li>標準正規分布のグラフ (緑)</li>
</ul>

<div class="org-src-container">
<pre class="src src-R">
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#33258;&#30001;&#24230;1&#65292;2&#65292;4&#65292;8&#65292;16 &#12398; t-&#20998;&#24067;&#12398;&#12464;&#12521;&#12501;</span>
<span style="color: #99968b;">## </span><span style="color: #99968b;">&#27161;&#28310;&#27491;&#35215;&#20998;&#24067;&#12398;&#12464;&#12521;&#12501; (&#32209;)</span>

curve(dnorm(x), -5, 5, col=<span style="color: #95e454;">"green"</span>, main=<span style="color: #95e454;">"t-&#20998;&#24067;"</span>)
<span style="color: #8ac6f2; font-weight: bold;">for</span>(i <span style="color: #8ac6f2; font-weight: bold;">in</span> 1:4) {
  curve(dt(x,2^i), -5, 5, add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)  
}

</pre>
</div>


<div class="figure">
<p><img src="./RforS/graph/fig-05-03.png" alt="fig-05-03.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd5fae40" class="outline-3">
<h3 id="orgd5fae40">標本</h3>
<div class="outline-text-3" id="text-orgd5fae40">
<div class="org-src-container">
<pre class="src src-R">
&#25351;&#23566;&#27861;&#12487;&#12540;&#12479; <span style="color: #e5786d;">&lt;-</span> read.csv(<span style="color: #95e454;">"data/shidouhouU8.csv"</span>)
(&#24515;&#29702;&#23398;&#12486;&#12473;&#12488; <span style="color: #e5786d;">&lt;-</span> &#25351;&#23566;&#27861;&#12487;&#12540;&#12479;$psych_test)

</pre>
</div>

<pre class="example">
[1] 13 14  7 12 10  6  8 15  4 14  9  6 10 12  5 12  8  8 12 15

</pre>
</div>
</div>


<div id="outline-container-orge194154" class="outline-3">
<h3 id="orge194154">帰無仮説と対立仮説の設定</h3>
<div class="outline-text-3" id="text-orge194154">
<dl class="org-dl">
<dt>帰無仮説</dt><dd>\( \mu = 12\)</dd>
<dt>対立仮説</dt><dd>\( \mu \neq 12 \)</dd>
</dl>
</div>
</div>

<div id="outline-container-orgda1420d" class="outline-3">
<h3 id="orgda1420d">統計検定量の選択</h3>
<div class="outline-text-3" id="text-orgda1420d">
<p>
母分散が未知なので，標本不偏分散を用いる。
</p>

<div class="org-src-container">
<pre class="src src-R">
<span style="color: #cae682;">t_stat</span> <span style="color: #e5786d;">&lt;-</span> <span style="color: #8ac6f2; font-weight: bold;">function</span> (X) {
  (mean(X)-this.mean) / sqrt(var(X)/length(X))
}

</pre>
</div>
</div>
</div>

<div id="outline-container-orgf77fbb1" class="outline-3">
<h3 id="orgf77fbb1">有意水準の決定</h3>
<div class="outline-text-3" id="text-orgf77fbb1">
<div class="org-src-container">
<pre class="src src-R">
this.mean <span style="color: #e5786d;">&lt;-</span>12
this.alpha <span style="color: #e5786d;">&lt;-</span> 0.05

</pre>
</div>
</div>
</div>

<div id="outline-container-org4c1c628" class="outline-3">
<h3 id="org4c1c628">検定統計量の実現値を求める</h3>
<div class="outline-text-3" id="text-org4c1c628">
<div class="org-src-container">
<pre class="src src-R">(t <span style="color: #e5786d;">&lt;-</span> t_stat(&#24515;&#29702;&#23398;&#12486;&#12473;&#12488;))

</pre>
</div>

<pre class="example">
[1] -2.616648

</pre>
</div>
</div>

<div id="outline-container-org0ea223c" class="outline-3">
<h3 id="org0ea223c">帰無仮説の棄却 or 採択の決定</h3>
<div class="outline-text-3" id="text-org0ea223c">
<div class="org-src-container">
<pre class="src src-R">
<span style="color: #8ac6f2; font-weight: bold;">if</span> ( pt(t,19)*2 &gt; this.alpha ) {  print(<span style="color: #95e454;">"mu==12"</span>)  } <span style="color: #8ac6f2; font-weight: bold;">else</span> {   print(<span style="color: #95e454;">"mu/=12"</span>) }

</pre>
</div>

<pre class="example">
[1] "mu/=12"

</pre>
</div>
</div>

<div id="outline-container-org92c368f" class="outline-3">
<h3 id="org92c368f">棄却域の描画</h3>
<div class="outline-text-3" id="text-org92c368f">
<div class="org-src-container">
<pre class="src src-R">curve(dt(x,19), -3, 3)
t.lower <span style="color: #e5786d;">&lt;-</span> qt(this.alpha/2,19)
t.upper <span style="color: #e5786d;">&lt;-</span> qt(1-this.alpha/2,19)
abline(v=t.lower)
abline(v=t.upper)
curve(x-x-0.01, xlim=c(-3,t.lower), col=<span style="color: #95e454;">'green'</span>,lwd=20,add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)
curve(x-x-0.01, xlim=c(t.upper,3), col=<span style="color: #95e454;">'green'</span>,lwd=20,add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)
</pre>
</div>


<div class="figure">
<p><img src="./RforS/graph/fig-05-04.png" alt="fig-05-04.png" />
</p>
</div>
</div>
</div>



<div id="outline-container-org272a0aa" class="outline-3">
<h3 id="org272a0aa">t-test</h3>
<div class="outline-text-3" id="text-org272a0aa">
<div class="org-src-container">
<pre class="src src-R">
t.test(&#24515;&#29702;&#23398;&#12486;&#12473;&#12488;, mu=12)

</pre>
</div>

<pre class="example">

	One Sample t-test

data:  心理学テスト
t = -2.6166, df = 19, p-value = 0.01697
alternative hypothesis: true mean is not equal to 12
95 percent confidence interval:
  8.400225 11.599775
sample estimates:
mean of x 
       10
</pre>


<div class="org-src-container">
<pre class="src src-R">
t.test(&#24515;&#29702;&#23398;&#12486;&#12473;&#12488;, mu=11)

</pre>
</div>

<pre class="example">

	One Sample t-test

data:  心理学テスト
t = -1.3083, df = 19, p-value = 0.2064
alternative hypothesis: true mean is not equal to 11
95 percent confidence interval:
  8.400225 11.599775
sample estimates:
mean of x 
       10
</pre>
</div>
</div>
</div>

<div id="outline-container-org29c683c" class="outline-2">
<h2 id="org29c683c">5.5 相関係数の検定 (無相関検定)</h2>
<div class="outline-text-2" id="text-org29c683c">
<ul class="org-ul">
<li>参考:: <a href="http://www.ipc.shimane-u.ac.jp/food/kobayasi/soukankeisuunokentei.htm">相関係数の検定の仕方</a></li>
</ul>


<p>
帰無仮説として，「母集団において相関が0である」と設定
</p>

<ul class="org-ul">
<li>母集団相関係数 (母相関)に関する検定を行なうとき</li>
<li><p>
標本相関係数の変換
</p>

<p>
\[
      t = \frac {r \sqrt{(n-2)}} {\sqrt{ 1-r^2 }}
      \]
</p></li>
</ul>


<ul class="org-ul">
<li>すると，t は自由度 n-2 の t-分布にしたがう</li>
</ul>
</div>


<div id="outline-container-org002aaf1" class="outline-3">
<h3 id="org002aaf1">例題</h3>
<div class="outline-text-3" id="text-org002aaf1">
<p>
指導法データについて，統計テスト1と統計テスト2の得点の相関係数の
検定を行ってください。
</p>

<p>
有意水準5%の両側検定とします。
</p>
</div>

<div id="outline-container-orgce17952" class="outline-4">
<h4 id="orgce17952">標本</h4>
<div class="outline-text-4" id="text-orgce17952">
<div class="org-src-container">
<pre class="src src-R">
    &#25351;&#23566;&#27861;&#12487;&#12540;&#12479; <span style="color: #e5786d;">&lt;-</span> read.csv(<span style="color: #95e454;">"data/shidouhouU8.csv"</span>)
    (&#32113;&#35336;&#12486;&#12473;&#12488;1 <span style="color: #e5786d;">&lt;-</span> &#25351;&#23566;&#27861;&#12487;&#12540;&#12479;$stat_test1)
    (&#32113;&#35336;&#12486;&#12473;&#12488;2 <span style="color: #e5786d;">&lt;-</span> &#25351;&#23566;&#27861;&#12487;&#12540;&#12479;$stat_test2)

</pre>
</div>

<pre class="example">
[1]  6 10  6 10  5  3  5  9  3  3 11  6 11  9  7  5  8  7  7  9
[1] 10 13  8 15  8  6  9 10  7  3 18 14 18 11 12  5  7 12  7  7

</pre>
</div>
</div>

<div id="outline-container-orgd14f1f9" class="outline-4">
<h4 id="orgd14f1f9">統計検定量</h4>
<div class="outline-text-4" id="text-orgd14f1f9">
<div class="org-src-container">
<pre class="src src-R">
this.alpha =0.05
this.pho = 0

<span style="color: #cae682;">pho_stat</span> <span style="color: #e5786d;">&lt;-</span> <span style="color: #8ac6f2; font-weight: bold;">function</span>(X1,X2) {
  n <span style="color: #e5786d;">&lt;-</span> length(X1)
  r <span style="color: #e5786d;">&lt;-</span> cor(X1,X2)
  r*sqrt(n-2) / sqrt( 1-r^2)
}

cor(&#32113;&#35336;&#12486;&#12473;&#12488;1,&#32113;&#35336;&#12486;&#12473;&#12488;2)
pho_stat(&#32113;&#35336;&#12486;&#12473;&#12488;1,&#32113;&#35336;&#12486;&#12473;&#12488;2)

</pre>
</div>

<pre class="example">
[1] 0.749659
[1] 4.805707

</pre>
</div>
</div>


<div id="outline-container-org419cddc" class="outline-4">
<h4 id="org419cddc">帰無仮説と対立仮説の設定</h4>
<div class="outline-text-4" id="text-org419cddc">
<div class="org-src-container">
<pre class="src src-R">
<span style="color: #8ac6f2; font-weight: bold;">if</span> ( pt(t,17)*2 &gt; this.alpha ) {  print(<span style="color: #95e454;">"pho==0"</span>)  } <span style="color: #8ac6f2; font-weight: bold;">else</span> {   print(<span style="color: #95e454;">"pho/=0"</span>) }

</pre>
</div>

<pre class="example">
[1] "pho/=0"

</pre>
</div>
</div>

<div id="outline-container-org02a17b6" class="outline-4">
<h4 id="org02a17b6">cor.test()</h4>
<div class="outline-text-4" id="text-org02a17b6">
<div class="org-src-container">
<pre class="src src-R">
cor.test(&#32113;&#35336;&#12486;&#12473;&#12488;1, &#32113;&#35336;&#12486;&#12473;&#12488;2)

</pre>
</div>

<pre class="example">

	Pearson's product-moment correlation

data:  統計テスト1 and 統計テスト2
t = 4.8057, df = 18, p-value = 0.0001416
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4596086 0.8952048
sample estimates:
     cor 
0.749659

</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orge67e3c8" class="outline-2">
<h2 id="orge67e3c8">5.6 独立性の検定（カイ二乗検定）</h2>
<div class="outline-text-2" id="text-orge67e3c8">
<dl class="org-dl">
<dt>独立性の検定</dt><dd>二つの質的変数が独立か</dd>
</dl>

<p>
3.5節の数学と統計の好き嫌いの間の <b>連関</b> を考える
</p>
</div>

<div id="outline-container-org5c4630d" class="outline-3">
<h3 id="org5c4630d">クロス集計表</h3>
<div class="outline-text-3" id="text-org5c4630d">
<div class="org-src-container">
<pre class="src src-R">
&#25351;&#23566;&#27861;&#12487;&#12540;&#12479; <span style="color: #e5786d;">&lt;-</span> read.csv(<span style="color: #95e454;">"data/shidouhouU8.csv"</span>)
(&#25968;&#23398;s <span style="color: #e5786d;">&lt;-</span> &#25351;&#23566;&#27861;&#12487;&#12540;&#12479;$math)
(&#32113;&#35336;s <span style="color: #e5786d;">&lt;-</span> &#25351;&#23566;&#27861;&#12487;&#12540;&#12479;$stat)

<span style="color: #99968b;">#</span><span style="color: #99968b;">&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;&#12398;&#20316;&#25104;</span>

(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920; <span style="color: #e5786d;">&lt;-</span> table(&#25968;&#23398;s, &#32113;&#35336;s))

</pre>
</div>

<pre class="example">
 [1] 嫌い 嫌い 好き 好き 嫌い 嫌い 嫌い 嫌い 嫌い 好き 好き 嫌い 好き 嫌い 嫌い
[16] 好き 嫌い 嫌い 嫌い 嫌い
Levels: 嫌い 好き
 [1] 好き 好き 好き 好き 嫌い 嫌い 嫌い 嫌い 嫌い 嫌い 好き 好き 好き 嫌い 好き
[16] 嫌い 嫌い 嫌い 嫌い 嫌い
Levels: 嫌い 好き
      統計s
数学s 嫌い 好き
  嫌い   10    4
  好き    2    4
</pre>
</div>
</div>

<div id="outline-container-org6266c90" class="outline-3">
<h3 id="org6266c90">問題</h3>
<div class="outline-text-3" id="text-org6266c90">
<p>
数学と統計の好き嫌いの間に有意な連関があると言えるでしょうか？
有意水準 5% で検定してください。
</p>
</div>
</div>

<div id="outline-container-orgba0d8e4" class="outline-3">
<h3 id="orgba0d8e4">カイ二乗検定</h3>
<div class="outline-text-3" id="text-orgba0d8e4">
<dl class="org-dl">
<dt>\( O_i \)</dt><dd>観測度数</dd>
<dt>\( E_i \)</dt><dd><p>
期待度数 (あらかじめ期待される，または，理論的に求
められる，度数)
</p>

<p>
\[
       \Chi^2 = \sum_1^k \frac {(O_i - E_i)^2 } { E_i}
       \]
</p></dd>
</dl>

<div class="org-src-container">
<pre class="src src-R">
curve(dchisq(x,1), 0, 20)
<span style="color: #8ac6f2; font-weight: bold;">for</span> (i <span style="color: #8ac6f2; font-weight: bold;">in</span> seq(2,16,2)) {
  curve(dchisq(x,i), 0, 20, add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)
  }

curve(dchisq(x,1), 0, 20)
<span style="color: #8ac6f2; font-weight: bold;">for</span> (i <span style="color: #8ac6f2; font-weight: bold;">in</span> 2:4) {
  curve(dchisq(x,2^i), 0, 20, add=<span style="color: #92a65e; font-weight: bold;">TRUE</span>)
  }
dev.off()
</pre>
</div>


<div class="figure">
<p><img src="./RforS/graph/Fig-05-06.png" alt="Fig-05-06.png" />
</p>
</div>


<ul class="org-ul">
<li>取り得る値の下限は0</li>
<li>非対称分布</li>
<li>自由度が大きくなると，正規分布に近づく</li>
</ul>
</div>
</div>

<div id="outline-container-orga23f393" class="outline-3">
<h3 id="orga23f393">統計検定量</h3>
<div class="outline-text-3" id="text-orga23f393">
<div class="org-src-container">
<pre class="src src-R">
(<span style="color: #cae682;">chi2_stat</span> <span style="color: #e5786d;">&lt;-</span> <span style="color: #8ac6f2; font-weight: bold;">function</span>(Ob,Ex) {
  sum((Ob-Ex)^2 / Ex)
})

</pre>
</div>

<pre class="example">
function(Ob,Ex) {
  sum((Ob-Ex)^2 / Ex)
}

</pre>


<div class="org-src-container">
<pre class="src src-R">sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[1,])
sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[2,])

</pre>
</div>

<pre class="example">
[1] 14
[1] 6

</pre>

<div class="org-src-container">
<pre class="src src-R">sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[,1])
sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[,2])

</pre>
</div>

<pre class="example">
[1] 12
[1] 8

</pre>

<div class="org-src-container">
<pre class="src src-R">( total <span style="color: #e5786d;">&lt;-</span> sum(sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[,1]),sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[,2])) )

&#26399;&#24453;&#24230;&#25968;s <span style="color: #e5786d;">&lt;-</span> matrix(nrow=2, ncol=2)
<span style="color: #8ac6f2; font-weight: bold;">for</span>(i <span style="color: #8ac6f2; font-weight: bold;">in</span> 1:2) {
  sc <span style="color: #e5786d;">&lt;-</span> sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[i,])
  <span style="color: #8ac6f2; font-weight: bold;">for</span>(j <span style="color: #8ac6f2; font-weight: bold;">in</span> 1:2) {
    sr <span style="color: #e5786d;">&lt;-</span> sum(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;[,j])
    &#26399;&#24453;&#24230;&#25968;s[i,j] <span style="color: #e5786d;">&lt;-</span> sc*sr/total
  }
}
&#26399;&#24453;&#24230;&#25968;s

</pre>
</div>

<pre class="example">
[1] 20
     [,1] [,2]
[1,]  8.4  5.6
[2,]  3.6  2.4

</pre>

<div class="org-src-container">
<pre class="src src-R">
&#35251;&#28204;&#24230;&#25968;s <span style="color: #e5786d;">&lt;-</span> &#12463;&#12525;&#12473;&#38598;&#35336;&#34920;

(chi2 <span style="color: #e5786d;">&lt;-</span> (&#35251;&#28204;&#24230;&#25968;s-&#26399;&#24453;&#24230;&#25968;s)^2/&#26399;&#24453;&#24230;&#25968;s)

sum(chi2)

</pre>
</div>

<pre class="example">
      統計s
数学s      嫌い      好き
  嫌い 0.3047619 0.4571429
  好き 0.7111111 1.0666667
[1] 2.539683

</pre>
</div>
</div>

<div id="outline-container-org2111357" class="outline-3">
<h3 id="org2111357">p 値</h3>
</div>



<div id="outline-container-org2b610c2" class="outline-3">
<h3 id="org2b610c2">chisq.test</h3>
<div class="outline-text-3" id="text-org2b610c2">
<p>
nxm のクロス集計表のカイ二乗検定の自由度は，
\( (n-1)x(m-1) \)
</p>

<div class="org-src-container">
<pre class="src src-R">
chisq.test(&#12463;&#12525;&#12473;&#38598;&#35336;&#34920;)

</pre>
</div>

<pre class="example">

	Pearson's Chi-squared test with Yates' continuity correction

data:  クロス集計表
X-squared = 1.2004, df = 1, p-value = 0.2732

 警告メッセージ: 
 chisq.test(クロス集計表) で:   カイ自乗近似は不正確かもしれません

</pre>
</div>
</div>
</div>

<div id="outline-container-org24630f1" class="outline-2">
<h2 id="org24630f1">5.7 サンプルサイズの検定結果への影響について</h2>
<div class="outline-text-2" id="text-org24630f1">
</div>
<div id="outline-container-org910d5f7" class="outline-3">
<h3 id="org910d5f7">サンプル数が異なる二つのクロス集計表の順位</h3>
<div class="outline-text-3" id="text-org910d5f7">
</div>
<div id="outline-container-orgf11dfdf" class="outline-4">
<h4 id="orgf11dfdf">履修A</h4>
<div class="outline-text-4" id="text-orgf11dfdf">
<div class="org-src-container">
<pre class="src src-R">    <span style="color: #e5786d;">library</span>(vcd)
    (&#23653;&#20462;A <span style="color: #e5786d;">&lt;-</span> matrix(c(16,12,4,8), 2, 2))
    rownames(&#23653;&#20462;A) <span style="color: #e5786d;">&lt;-</span> c(<span style="color: #95e454;">"&#25991;&#31995;"</span>, <span style="color: #95e454;">"&#29702;&#31995;"</span>)
    colnames(&#23653;&#20462;A) <span style="color: #e5786d;">&lt;-</span> c(<span style="color: #95e454;">"&#23653;&#20462;&#12375;&#12383;"</span>,<span style="color: #95e454;">"&#23653;&#20462;&#12375;&#12394;&#12356;"</span>)
    &#23653;&#20462;A
</pre>
</div>

<pre class="example">
     [,1] [,2]
[1,]   16    4
[2,]   12    8
     履修した 履修しない
文系       16          4
理系       12          8

</pre>
</div>
</div>


<div id="outline-container-org2126c85" class="outline-4">
<h4 id="org2126c85">履修B</h4>
<div class="outline-text-4" id="text-org2126c85">
<div class="org-src-container">
<pre class="src src-R">      (&#23653;&#20462;B <span style="color: #e5786d;">&lt;-</span> matrix(c(160,120,40,80), 2, 2))
      rownames(&#23653;&#20462;B) <span style="color: #e5786d;">&lt;-</span> c(<span style="color: #95e454;">"&#25991;&#31995;"</span>, <span style="color: #95e454;">"&#29702;&#31995;"</span>)
      colnames(&#23653;&#20462;B) <span style="color: #e5786d;">&lt;-</span> c(<span style="color: #95e454;">"&#23653;&#20462;&#12375;&#12383;"</span>,<span style="color: #95e454;">"&#23653;&#20462;&#12375;&#12394;&#12356;"</span>)
      &#23653;&#20462;B
</pre>
</div>

<pre class="example">
     [,1] [,2]
[1,]  160   40
[2,]  120   80
     履修した 履修しない
文系      160         40
理系      120         80

</pre>
</div>
</div>
</div>

<div id="outline-container-org2f30d0a" class="outline-3">
<h3 id="org2f30d0a">カイ二乗検定</h3>
<div class="outline-text-3" id="text-org2f30d0a">
<div class="org-src-container">
<pre class="src src-R">
chisq.test(&#23653;&#20462;A, correct=<span style="color: #92a65e; font-weight: bold;">FALSE</span>)

</pre>
</div>

<pre class="example">

	Pearson's Chi-squared test

data:  履修A
X-squared = 1.9048, df = 1, p-value = 0.1675

</pre>

<div class="org-src-container">
<pre class="src src-R">

chisq.test(&#23653;&#20462;B, correct=<span style="color: #92a65e; font-weight: bold;">FALSE</span>)

</pre>
</div>

<pre class="example">

	Pearson's Chi-squared test

data:  履修B
X-squared = 19.048, df = 1, p-value = 1.275e-05

</pre>
</div>
</div>

<div id="outline-container-orgda50cba" class="outline-3">
<h3 id="orgda50cba">サンプル数の違い</h3>
<div class="outline-text-3" id="text-orgda50cba">
<p>
帰無仮説、帰無分布、棄却域は全く同じものとなります。
</p>

<p>
違うのは検定統計量の実現値だけです。
</p>

<p>
chisq.test関数により検定を行ってみましょう。
</p>

<p>
カイ二乗検定量に10倍違いがあり，検定は，有意になりやすくなる。
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: suzuki@iwate-u.ac.jp 鈴木正幸，非常勤講師</p>
<p class="date">Created: 2021-12-13 月 14:24</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
